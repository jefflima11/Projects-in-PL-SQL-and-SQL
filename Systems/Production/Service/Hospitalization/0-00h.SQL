SELECT
 TO_CHAR(MOV_INT.DT_MOV_INT,'MM/YYYY') DATA_UNID,
 UNID_INT.CD_UNID_INT  CD_UNID_INT,
 UNID_INT.DS_UNID_INT  DS_UNIDADE,
 COUNT(*)              PAC_INT_00H

 From
  DBAMV.MOV_INT
 ,DBAMV.UNID_INT
 ,DBAMV.LEITO
 ,DBAMV.ATENDIME
 ,(
SELECT( TO_DATE( SYSDATE) -1  + ROWNUM )DATA
FROM DBAMV.CID
WHERE TO_DATE( SYSDATE)   -1  + ROWNUM <= TO_DATE(SYSDATE)
  ) CONTADOR

 WHERE
     Trunc(DT_MOV_INT) <= CONTADOR.DATA - 1
 And TRUNC(NVL(DT_LIB_MOV, SYSDATE) ) > CONTADOR.DATA - 1
 And  TP_MOV IN('O', 'I')
 And  LEITO.CD_UNID_INT       =  UNID_INT.CD_UNID_INT
 And  MOV_INT.CD_ATENDIMENTO  =  ATENDIME.CD_ATENDIMENTO
 And  MOV_INT.CD_LEITO        =  LEITO.CD_LEITO
 and Nvl(Dbamv.F_Valida_Data_Hospital_Dia('N',ATENDIME.DT_ALTA),'N') = 'S'
 AND ATENDIME.TP_ATENDIMENTO  = 'I'
 AND ATENDIME.CD_ATENDIMENTO_PAI IS NULL
 AND UNID_INT.CD_UNID_INT IN (2,11,26)
 Group BY
 TO_CHAR(MOV_INT.DT_MOV_INT,'MM/YYYY'),
 UNID_INT.CD_UNID_INT,
 UNID_INT.DS_UNID_INT

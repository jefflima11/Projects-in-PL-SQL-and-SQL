CREATE OR REPLACE PROCEDURE SP_RETORNA_DADOS_REPASSE_OTORRINO(
	PCD_PRESTADOR IN NUMBER,
	
)

SELECT	DISTINCT
				PA.NM_PRESTADOR,
				'PC: ' ||PF.CD_PRO_FAT||' , PAC: ' ||P.NM_PACIENTE||' , DATA: '||TO_DATE(IRF.DT_LANCAMENTO,'DD/MM/YYYY') DESCRICAO,
				CASE
					WHEN PF.CD_PRO_FAT = 99990037 THEN	514.71
					WHEN PF.CD_PRO_FAT = 99990038 THEN	369.16
					WHEN PF.CD_PRO_FAT = 99990039 THEN	736.82
					WHEN PF.CD_PRO_FAT = 99990040 THEN	148.33
					WHEN PF.CD_PRO_FAT = 99990041 THEN	29.20
					WHEN PF.CD_PRO_FAT = 99990042 THEN	351.34
					WHEN PF.CD_PRO_FAT = 99990043 THEN	216.40
					WHEN PF.CD_PRO_FAT = 99990044 THEN	284.09
					WHEN PF.CD_PRO_FAT = 99990045 THEN	348.79
					WHEN PF.CD_PRO_FAT = 99990046 THEN	271.80
					WHEN PF.CD_PRO_FAT = 99990047 THEN	53.31
					WHEN PF.CD_PRO_FAT = 99990048 THEN	37.85
					WHEN PF.CD_PRO_FAT = 99990049 THEN	177.39
					WHEN PF.CD_PRO_FAT = 99990135 THEN	1105.98
				ELSE	0
				END VL_REPASSE
FROM		DBAMV.REG_FAT RF
					INNER JOIN DBAMV.ITREG_FAT IRF
						ON	RF.CD_REG_FAT = IRF.CD_REG_FAT
					INNER JOIN DBAMV.REMESSA_FATURA RE
						ON 	RF.CD_REMESSA = RE.CD_REMESSA
					INNER JOIN DBAMV.FATURA F
						ON	RE.CD_FATURA = F.CD_FATURA
					INNER JOIN DBAMV.AVISO_CIRURGIA AC
						ON	RF.CD_ATENDIMENTO = AC.CD_ATENDIMENTO
					INNER JOIN DBAMV.CIRURGIA_AVISO CA
						ON 	AC.CD_AVISO_CIRURGIA = CA.CD_AVISO_CIRURGIA
					INNER JOIN DBAMV.PRESTADOR_AVISO PA
						ON 	AC.CD_AVISO_CIRURGIA = PA.CD_AVISO_CIRURGIA
 						AND	CA.CD_CIRURGIA_AVISO = PA.CD_CIRURGIA_AVISO
					INNER JOIN DBAMV.ATENDIME A
						ON 	RF.CD_ATENDIMENTO = A.CD_ATENDIMENTO
					INNER JOIN DBAMV.PACIENTE P
						ON 	A.CD_PACIENTE = P.CD_PACIENTE
					INNER JOIN DBAMV.PRO_FAT PF
						ON	IRF.CD_PRO_FAT = PF.CD_PRO_FAT
WHERE		IRF.CD_PRO_FAT IN (99990135,99990037,99990038,99990039,99990040,99990041,99990042,99990043,99990044,99990045,99990046,99990047,99990048,99990049)
	AND 	PA.CD_ATI_MED = 01
	AND   PA.CD_PRESTADOR = 245
	AND		TO_CHAR(IRF.DT_LANCAMENTO,'MM/YYYY') = '04/2024'
  AND 	CA.SN_PRINCIPAL = 'S'
/
